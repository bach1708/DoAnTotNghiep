@model List<MangaShop.Models.DonHang>

@{
    ViewData["Title"] = "Quản lý đơn hàng";
    Layout = "_AdminLayout";
}

<link rel="stylesheet" href="~/css/BillAdmin.css" />

<div class="container-admin-1600">
    <div class="d-flex justify-content-between align-items-center mb-4 mt-3">
        <div>
            <h2 class="page-title">📦 QUẢN LÝ ĐƠN HÀNG</h2>
            <p class="text-muted small">Hệ thống quản lý trạng thái đơn hàng và thanh toán</p>
        </div>
        <a asp-controller="NvbAdmin" asp-action="Index" class="btn-back">
            <i class="fa-solid fa-arrow-left"></i>
        </a>
    </div>

    <div class="table-card shadow-sm">
        <table class="table custom-table-order">
            <thead>
                <tr>
                    <th>Mã đơn</th>
                    <th>Khách hàng</th>
                    <th>Ngày đặt</th>
                    <th>Tổng tiền</th>
                    <th>Thanh toán</th>
                    <th>Trạng thái</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td class="fw-bold">#@item.MaDonHang</td>
                        <td class="customer-link">@item.MaKhachHangNavigation.HoTen</td>
                        <td class="text-secondary">@item.NgayDat?.ToString("dd/MM/yyyy HH:mm")</td>
                        <td class="text-price">@item.TongTien.ToString("N0") ₫</td>
                        <td class="small">@item.PhuongThucThanhToan</td>
                        <td>
                            <form asp-action="UpdateStatus" method="post" class="status-box">
                                <input type="hidden" name="id" value="@item.MaDonHang" />
                                <div class="input-group input-group-sm">
                                    <select name="trangThai" class="form-select status-select">
                                        <option value="Chờ xử lý" selected="@(item.TrangThai == "Chờ xử lý")">Chờ xử lý</option>
                                        <option value="Đang giao" selected="@(item.TrangThai == "Đang giao")">Đang giao</option>
                                        <option value="Hoàn thành" selected="@(item.TrangThai == "Hoàn thành")">Hoàn thành</option>
                                        <option value="Huỷ" selected="@(item.TrangThai == "Huỷ")">Huỷ</option>
                                    </select>
                                    <button class="btn btn-save-status">✔</button>
                                </div>
                            </form>
                        </td>
                        <td>
                            <a asp-action="BillDetailAdmin" asp-route-id="@item.MaDonHang" class="action-link">
                                Chi tiết
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>